[{"id":"591414d3.a6ebec","type":"template","z":"5b2319c1.667af8","name":"Get audio and play the audio in Browser","field":"","template":"<!DOCTYPE html>\n<html>\n<head>\n  <title>Sensor data voice message using: IBM Watson - Text To Speech</title>\n  <style>\n    html, body, #map-canvas {\n      height: 100%;\n      margin: 0px;\n      padding: 0px\n    }\n    #header {\n      background-color:black;\n      color:white;\n      text-align:center;\n      padding:5px;\n    }\n    #footer {\n      background-color:black;\n      color:white;\n      clear:both;\n      text-align:center;\n      padding:5px;\n    }\n  </style>\n  <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js\"></script>\n\n  <script type=\"text/javascript\">\n    var socketaddy = \"ws://\" + window.location.host + \"/ws/audio\";\n    var count = 0;\n    $(document).ready(function(){\n      var output = document.getElementById('output')\n      $('#output').on('playing', function () {\n          $('#text').text('Playing audio.')\n\n      });\n\n      $('#output').on('ended', function () {\n          $('#text').text('Waiting for audio...')\n      });\n\n      sock = new WebSocket(socketaddy);\n      sock.onopen = function(){\n          $('#text').text('Waiting for audio...');\n          console.log(\"Connected websocket\");\n          document.getElementById(\"count\").innerHTML = \"Played audio messages: 0\";\n      };\n      sock.onerror = function(){\n          console.log(\"Websocket error\");\n      };\n      sock.onclose = function () {\n          $('#text').text('Not connected. Refresh the page?')\n      }\n      sock.onmessage = function(evt){\n        console.log(\"Websocket audio message\", evt);\n        output.src = window.URL.createObjectURL(evt.data);\n        output.play();\n        count = count + 1;\n        var message = \"\";\n        message = \"Played audio messages: \" + count\n        // Set the sensor count on HTML\n\t\t    document.getElementById(\"count\").innerHTML = message;\n      };\n    });\n  </script>\n\n</head>\n<body style=\"font-size: 56px; font-family: helvetica; text-align: center; margin-top: 100px;\">\n  <div id=\"header\">\n    <p>Hello this is the Voice message page</p>\n    <a href=\"http://owniotcloud.mybluemix.net/cloudant\">Go to Senosor data page</a>\n    <a href=\"http://owniotcloud.mybluemix.net/map\">Go to Senosor geo-location page</a>\n    <a href=\"http://owniotcloud.mybluemix.net/testing\">Go to Senosor data search page</a>\n    <p id=\"count\"></p>\n  </div>\n  <div id=\"text\">Connecting...</div>\n  <audio id=\"output\"></audio>\n</body>\n</html>","x":338,"y":477,"wires":[["96614680.699eb8"]]}]
